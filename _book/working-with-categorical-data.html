<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Working with categorical data | Discrete Data Analysis with R</title>
  <meta name="description" content="These are my excerpts and personal notes on the textbook “Discrete Data Analysis with R” by Michael Friendly and David Meyer." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Working with categorical data | Discrete Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are my excerpts and personal notes on the textbook “Discrete Data Analysis with R” by Michael Friendly and David Meyer." />
  <meta name="github-repo" content="petzi53/ddar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Working with categorical data | Discrete Data Analysis with R" />
  
  <meta name="twitter:description" content="These are my excerpts and personal notes on the textbook “Discrete Data Analysis with R” by Michael Friendly and David Meyer." />
  

<meta name="author" content="Peter Baumgartner" />


<meta name="date" content="2022-02-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="still-to-do.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/boxes.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Categorical Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#what-is-categorical-data"><i class="fa fa-check"></i><b>2.2</b> What is categorical data?</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#case-vs.-frequency-form"><i class="fa fa-check"></i><b>2.2.1</b> Case vs. frequency form</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction.html"><a href="introduction.html#univariate-bivariate-and-multivariate-data"><i class="fa fa-check"></i><b>2.2.2</b> Univariate, bivariate, and multivariate data</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction.html"><a href="introduction.html#explanatory-vs.-response-variables"><i class="fa fa-check"></i><b>2.2.3</b> Explanatory vs. response variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#data-analysis-strategies"><i class="fa fa-check"></i><b>2.3</b> Data analysis strategies</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction.html"><a href="introduction.html#hypothesis-testing-approaches"><i class="fa fa-check"></i><b>2.3.1</b> Hypothesis testing approaches</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction.html"><a href="introduction.html#model-building-approaches"><i class="fa fa-check"></i><b>2.3.2</b> Model building approaches</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#graphical-methods"><i class="fa fa-check"></i><b>2.4</b> Graphical methods</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction.html"><a href="introduction.html#visualization-recommendations"><i class="fa fa-check"></i><b>2.4.1</b> Visualization recommendations</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction.html"><a href="introduction.html#recommended-packages"><i class="fa fa-check"></i><b>2.4.2</b> Recommended Packages</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction.html"><a href="introduction.html#data-und-models-plot"><i class="fa fa-check"></i><b>2.4.3</b> Data und models plot</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#the-80-20-rule"><i class="fa fa-check"></i><b>2.5</b> The 80-20-rule</a></li>
<li class="chapter" data-level="2.6" data-path="introduction.html"><a href="introduction.html#visualization-of-distributions"><i class="fa fa-check"></i><b>2.6</b> Visualization of distributions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html"><i class="fa fa-check"></i><b>3</b> Working with categorical data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#forms-of-categorical-data"><i class="fa fa-check"></i><b>3.2</b> Forms of categorical data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#using-tabulizer"><i class="fa fa-check"></i><b>3.2.1</b> Using tabulizer</a></li>
<li class="chapter" data-level="3.2.2" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#generating-tables"><i class="fa fa-check"></i><b>3.2.2</b> Generating tables</a></li>
<li class="chapter" data-level="3.2.3" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#printing-tables"><i class="fa fa-check"></i><b>3.2.3</b> Printing tables</a></li>
<li class="chapter" data-level="3.2.4" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#collapsing-tables"><i class="fa fa-check"></i><b>3.2.4</b> Collapsing tables</a></li>
<li class="chapter" data-level="3.2.5" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#converting-tables"><i class="fa fa-check"></i><b>3.2.5</b> Converting tables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#a-complex-example"><i class="fa fa-check"></i><b>3.3</b> A complex example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="still-to-do.html"><a href="still-to-do.html"><i class="fa fa-check"></i><b>4</b> Still to do</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Discrete Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-categorical-data" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Working with categorical data</h1>
<div id="introduction-1" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<p>Creating and manipulating categorical data sets requires some skills and techniques in R beyond those ordinarily used for quantitative data. This chapter illustrates these for the main formats for categorical data: case form, frequency form and table form.</p>
<blockquote>
<p>The chapter uses many base R commands I am not familiar. But I believe that most of these command could be translated to the tidy data approach. The praxis will show, if I have the skills for these transformations. In this chapter I will focus on those command where I lack knowledge of their function either in base R or tidy approach.</p>
</blockquote>
<blockquote>
<p>For example there is a focus on matrices and arrays, data structures I am not comfortable with. But it should be easy to convert them to data frames or tibbles. Similiar with the graphic command <code>plot()</code> which I will replace with <code>ggplot().</code></p>
</blockquote>
</div>
<div id="forms-of-categorical-data" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Forms of categorical data</h2>
<blockquote>
<p>The book distinguishes between case, frequency and table form. I believe that this differentiation is with the tidy approach not essential anymore. More important nowadays is the conversion of data from wide to long with <code>pivot_longer()</code> and vice versa with <code>pivot_wider()</code>. But again: Practical challenges will be the proof of my assessment.</p>
</blockquote>
<div id="using-tabulizer" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Using tabulizer</h3>
<p>Instead of entering the data manually or importing from a file or website, I was experimenting with the <strong>{tabulizer}</strong> package. ‘Tabula’ is a Java library designed to computationally extract tables from PDF documents.</p>
<p>Sometimes there are problems with the employment as <strong>{rJava}</strong> is required and complicated to install. But I had it already installed and cant remember any problems. <strong>{tabulizerjars}</strong> is also necessary. The only purpose of <strong>{tabulizerjars}</strong> is to distribute releases of the ‘Tabula’ Java library to be used with the <strong>{tabulizer}</strong> package. Note that the package itself does not provide any functionality apart from basic linking to Java version installed on the system.</p>
<p>See the <a href="https://tabula.technology/">Tabula</a> webpage but first and foremost the <a href="https://docs.ropensci.org/tabulizer/index.html">rOpenSci web page on tabulizer</a> for more details and documentation of all the features.</p>
<p>The main function is <code>extract_tables()</code> with several parameters, for instance the page for the table to extracted. But in my case to provide the page resulted in the extraction of another table at the beginning of the page. Therefore I had to use the interactive <code>locate_areas()</code> function. The program stops and displays a mini picture of the desired PDF page where one can select the area with the table.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="working-with-categorical-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href="working-with-categorical-data.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizer)</span>
<span id="cb5-3"><a href="working-with-categorical-data.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizerjars)</span>
<span id="cb5-4"><a href="working-with-categorical-data.html#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="working-with-categorical-data.html#cb5-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(<span class="st">&quot;test-data/DDAR.pdf&quot;</span>)</span>
<span id="cb5-6"><a href="working-with-categorical-data.html#cb5-6" aria-hidden="true" tabindex="-1"></a>tab_area <span class="ot">&lt;-</span> <span class="fu">locate_areas</span>(<span class="at">file =</span> f, <span class="at">page =</span> <span class="dv">53</span>)</span>
<span id="cb5-7"><a href="working-with-categorical-data.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(tab_area, <span class="st">&quot;test-data/example-tab-area&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="working-with-categorical-data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.6     ✓ dplyr   1.0.7
## ✓ tidyr   1.1.4     ✓ stringr 1.4.0
## ✓ readr   2.1.1     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="working-with-categorical-data.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizer)</span>
<span id="cb10-2"><a href="working-with-categorical-data.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizerjars)</span>
<span id="cb10-3"><a href="working-with-categorical-data.html#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="working-with-categorical-data.html#cb10-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(<span class="st">&quot;test-data/DDAR.pdf&quot;</span>)</span>
<span id="cb10-5"><a href="working-with-categorical-data.html#cb10-5" aria-hidden="true" tabindex="-1"></a>tab_area <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;test-data/example-tab-area&quot;</span>)</span>
<span id="cb10-6"><a href="working-with-categorical-data.html#cb10-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">extract_tables</span>(<span class="at">file =</span> f,</span>
<span id="cb10-7"><a href="working-with-categorical-data.html#cb10-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">page =</span> <span class="dv">53</span>, </span>
<span id="cb10-8"><a href="working-with-categorical-data.html#cb10-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">area =</span> tab_area,</span>
<span id="cb10-9"><a href="working-with-categorical-data.html#cb10-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guess =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-10"><a href="working-with-categorical-data.html#cb10-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">output =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb10-11"><a href="working-with-categorical-data.html#cb10-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(df[[<span class="dv">1</span>]])</span>
<span id="cb10-12"><a href="working-with-categorical-data.html#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df[<span class="dv">1</span>, ])</span>
<span id="cb10-13"><a href="working-with-categorical-data.html#cb10-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb10-14"><a href="working-with-categorical-data.html#cb10-14" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">names_to =</span> <span class="st">&quot;party&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb10-15"><a href="working-with-categorical-data.html#cb10-15" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   sex    party count
##   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;
## 1 female dem   279  
## 2 female indep 73   
## 3 female rep   225  
## 4 male   dem   165  
## 5 male   indep 47   
## 6 male   rep   191</code></pre>
</div>
<div id="generating-tables" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Generating tables</h3>
<p>With data in case form or frequency form, you can generate frequency tables from factor variables in data frames using the <code>table()</code> function; for tables of proportions, use the <code>prop.table()</code> function, and for marginal frequencies (summing over some variables) use <code>margin.table()</code>.</p>
<div class="todobox">
<blockquote>
<p>I have to look up other books using modern approaches to see what functions they use, e.g., <a href="https://moderndive.netlify.app/index.html">ModernDive</a> (Statistical Inference via Data Science – A ModernDive into R and the Tidyverse). I believe the <strong>{janitor}</strong> packages may be helpful for <code>prop.table()</code> and <code>margin.table()</code> functionalities.</p>
</blockquote>
</div>
</div>
<div id="printing-tables" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Printing tables</h3>
<p>For 3-way and larger tables, the functions <code>ftable()</code> (in the <strong>{stats}</strong> package) and <code>structable()</code> (in <strong>{vcd}</strong>) provide a convenient and flexible tabular display in a “flat” (2-way) format.</p>
</div>
<div id="collapsing-tables" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Collapsing tables</h3>
<p>It sometimes happens that we have a data set with more variables or factors than we want to analyze. The book recommends <code>aggregate()</code> in {stats}, <code>margin.table()</code> resp. <code>marginSums()</code>, <code>apply()</code> both in {base}, and collapse.table()` from the <strong>{vcdExtra}</strong> package.</p>
<div class="todobox">
<blockquote>
<p>Again I have to find equivalents. I believe that the modern approach works with <strong>{dplyr}</strong>, <strong>{tidyr}</strong>, <strong>{purrr}</strong>, <strong>{tibble}</strong> and <strong>{forcats}</strong> (all provided by the <strong>{<a href="https://tidyverse.tidyverse.org/">tidyverse</a>}</strong> package suite.)</p>
</blockquote>
</div>
</div>
<div id="converting-tables" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Converting tables</h3>
<p>A given contingency table can be represented equivalently in case form, frequency form, and table form. However, some R functions were designed for one particular representation. Therefore converting tables from one form to another, are critical.</p>
<p>In addition to the already mentioned functions of <code>table()</code>, <code>xtabs()</code> and <code>as.data.frame()</code> the book references the <code>expand.dft()</code> function in <strong>{vcdExtra}</strong>. For producing a LateX table the <strong>{xtable}</strong> package is recommended.</p>
<blockquote>
<p>Am not sure if the tidyverse() packages solves these conversion problems. But to know more about the requirements I will print the output from different table commands.</p>
</blockquote>
<p>I am going to use for this task the <code>UCBAdmissions</code> data from the base <strong>{datasets}</strong> package. For shorter reference I will copy it to <code>UCB.</code></p>
<p><strong>UCBAdmissions</strong>:The original structure of the table:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="working-with-categorical-data.html#cb12-1" aria-hidden="true" tabindex="-1"></a>(UCB <span class="ot">&lt;-</span> UCBAdmissions)</span></code></pre></div>
<pre><code>## , , Dept = A
## 
##           Gender
## Admit      Male Female
##   Admitted  512     89
##   Rejected  313     19
## 
## , , Dept = B
## 
##           Gender
## Admit      Male Female
##   Admitted  353     17
##   Rejected  207      8
## 
## , , Dept = C
## 
##           Gender
## Admit      Male Female
##   Admitted  120    202
##   Rejected  205    391
## 
## , , Dept = D
## 
##           Gender
## Admit      Male Female
##   Admitted  138    131
##   Rejected  279    244
## 
## , , Dept = E
## 
##           Gender
## Admit      Male Female
##   Admitted   53     94
##   Rejected  138    299
## 
## , , Dept = F
## 
##           Gender
## Admit      Male Female
##   Admitted   22     24
##   Rejected  351    317</code></pre>
<p><strong>ftable()</strong>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="working-with-categorical-data.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(UCB)</span></code></pre></div>
<pre><code>##                 Dept   A   B   C   D   E   F
## Admit    Gender                             
## Admitted Male        512 353 120 138  53  22
##          Female       89  17 202 131  94  24
## Rejected Male        313 207 205 279 138 351
##          Female       19   8 391 244 299 317</code></pre>
<p><strong>ftable with formula method</strong>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="working-with-categorical-data.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ftable(UCB, row.vars = 1:2)      # same result</span></span>
<span id="cb16-2"><a href="working-with-categorical-data.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(Admit <span class="sc">+</span> Gender <span class="sc">~</span> Dept, <span class="at">data =</span> UCB)   <span class="co"># formula method</span></span></code></pre></div>
<pre><code>##      Admit  Admitted        Rejected       
##      Gender     Male Female     Male Female
## Dept                                       
## A                512     89      313     19
## B                353     17      207      8
## C                120    202      205    391
## D                138    131      279    244
## E                 53     94      138    299
## F                 22     24      351    317</code></pre>
<p><strong>as_tibble()</strong>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="working-with-categorical-data.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(UCB)</span></code></pre></div>
<pre><code>## # A tibble: 24 × 4
##    Admit    Gender Dept      n
##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;
##  1 Admitted Male   A       512
##  2 Rejected Male   A       313
##  3 Admitted Female A        89
##  4 Rejected Female A        19
##  5 Admitted Male   B       353
##  6 Rejected Male   B       207
##  7 Admitted Female B        17
##  8 Rejected Female B         8
##  9 Admitted Male   C       120
## 10 Rejected Male   C       205
## # … with 14 more rows</code></pre>
<p><strong>structable()</strong>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="working-with-categorical-data.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcd)</span></code></pre></div>
<pre><code>## Loading required package: grid</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="working-with-categorical-data.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">structable</span>(UCB)</span></code></pre></div>
<pre><code>##               Gender Male Female
## Admit    Dept                   
## Admitted A            512     89
##          B            353     17
##          C            120    202
##          D            138    131
##          E             53     94
##          F             22     24
## Rejected A            313     19
##          B            207      8
##          C            205    391
##          D            279    244
##          E            138    299
##          F            351    317</code></pre>
<blockquote>
<p>It seems to me that all the complex discussion about different table formats is now outdated with <strong>{tibble}</strong> from the <strong>{tidyverse}</strong> approach. The same is true with <strong>{dplyr}</strong> concerning subsetting, filtering or other transforming activities. This is especially important for manipulating factor levels where the <strong>{forcats}</strong> packages replaces all the different function for aggregating and collapsing. But to learn &amp; decide what code is necessary I would need the actual problem. Therefore I just skimmed chapter 2.</p>
</blockquote>
</div>
</div>
<div id="a-complex-example" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> A complex example</h2>
<blockquote>
<p>A good conversion exercise is the following complex example on TV viewing data. So I can check if I am able to provide the necessary R code to fulfil the requirements. I have to inspect it line per line and relace it with working code. To see the difference I will keep the old code as comments.</p>
</blockquote>
<blockquote>
<p>(I will do this another time… – I have to separate the different steps with subtitles and comments about my changes.)</p>
</blockquote>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="working-with-categorical-data.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Check with the original example, TV viewing data, p. 58ff.</span></span>
<span id="cb24-2"><a href="working-with-categorical-data.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra)</span>
<span id="cb24-3"><a href="working-with-categorical-data.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">## reading in the data</span></span>
<span id="cb24-4"><a href="working-with-categorical-data.html#cb24-4" aria-hidden="true" tabindex="-1"></a>tv_data <span class="ot">&lt;-</span> TV</span>
<span id="cb24-5"><a href="working-with-categorical-data.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tv_data)</span>
<span id="cb24-6"><a href="working-with-categorical-data.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tv_data, <span class="dv">5</span>)</span>
<span id="cb24-7"><a href="working-with-categorical-data.html#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="working-with-categorical-data.html#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="do">## tv_data &lt;- read.table(&quot;C:/R/data/tv.dat&quot;)</span></span>
<span id="cb24-9"><a href="working-with-categorical-data.html#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="working-with-categorical-data.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="do">## tv_data &lt;- read.table(file.choose())</span></span>
<span id="cb24-11"><a href="working-with-categorical-data.html#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="working-with-categorical-data.html#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="do">## creating factors within the data frame</span></span>
<span id="cb24-13"><a href="working-with-categorical-data.html#cb24-13" aria-hidden="true" tabindex="-1"></a>TV_df <span class="ot">&lt;-</span> tv_data</span>
<span id="cb24-14"><a href="working-with-categorical-data.html#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(TV_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Network&quot;</span>, <span class="st">&quot;State&quot;</span>, <span class="st">&quot;Freq&quot;</span>)</span>
<span id="cb24-15"><a href="working-with-categorical-data.html#cb24-15" aria-hidden="true" tabindex="-1"></a>TV_df <span class="ot">&lt;-</span> <span class="fu">within</span>(TV_df, {</span>
<span id="cb24-16"><a href="working-with-categorical-data.html#cb24-16" aria-hidden="true" tabindex="-1"></a>           Day <span class="ot">&lt;-</span> <span class="fu">factor</span>(Day,</span>
<span id="cb24-17"><a href="working-with-categorical-data.html#cb24-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>))</span>
<span id="cb24-18"><a href="working-with-categorical-data.html#cb24-18" aria-hidden="true" tabindex="-1"></a>           Time <span class="ot">&lt;-</span> <span class="fu">factor</span>(Time)</span>
<span id="cb24-19"><a href="working-with-categorical-data.html#cb24-19" aria-hidden="true" tabindex="-1"></a>           Network <span class="ot">&lt;-</span> <span class="fu">factor</span>(Network)</span>
<span id="cb24-20"><a href="working-with-categorical-data.html#cb24-20" aria-hidden="true" tabindex="-1"></a>           State <span class="ot">&lt;-</span> <span class="fu">factor</span>(State)</span>
<span id="cb24-21"><a href="working-with-categorical-data.html#cb24-21" aria-hidden="true" tabindex="-1"></a>     })</span>
<span id="cb24-22"><a href="working-with-categorical-data.html#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="working-with-categorical-data.html#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="do">## reshaping the table into a 4-way table</span></span>
<span id="cb24-24"><a href="working-with-categorical-data.html#cb24-24" aria-hidden="true" tabindex="-1"></a>TV <span class="ot">&lt;-</span> <span class="fu">array</span>(tv_data[,<span class="dv">5</span>], <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb24-25"><a href="working-with-categorical-data.html#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(TV) <span class="ot">&lt;-</span></span>
<span id="cb24-26"><a href="working-with-categorical-data.html#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>),</span>
<span id="cb24-27"><a href="working-with-categorical-data.html#cb24-27" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">&quot;8:00&quot;</span>, <span class="st">&quot;8:15&quot;</span>, <span class="st">&quot;8:30&quot;</span>, <span class="st">&quot;8:45&quot;</span>, <span class="st">&quot;9:00&quot;</span>, <span class="st">&quot;9:15&quot;</span>,</span>
<span id="cb24-28"><a href="working-with-categorical-data.html#cb24-28" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;9:30&quot;</span>, <span class="st">&quot;9:45&quot;</span>, <span class="st">&quot;10:00&quot;</span>, <span class="st">&quot;10:15&quot;</span>, <span class="st">&quot;10:30&quot;</span>),</span>
<span id="cb24-29"><a href="working-with-categorical-data.html#cb24-29" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">&quot;ABC&quot;</span>, <span class="st">&quot;CBS&quot;</span>, <span class="st">&quot;NBC&quot;</span>, <span class="st">&quot;Fox&quot;</span>, <span class="st">&quot;Other&quot;</span>),</span>
<span id="cb24-30"><a href="working-with-categorical-data.html#cb24-30" aria-hidden="true" tabindex="-1"></a>         <span class="fu">c</span>(<span class="st">&quot;Off&quot;</span>, <span class="st">&quot;Switch&quot;</span>, <span class="st">&quot;Persist&quot;</span>))</span>
<span id="cb24-31"><a href="working-with-categorical-data.html#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">dimnames</span>(TV)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Network&quot;</span>, <span class="st">&quot;State&quot;</span>)</span>
<span id="cb24-32"><a href="working-with-categorical-data.html#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="working-with-categorical-data.html#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Creating the table using xtabs()</span></span>
<span id="cb24-34"><a href="working-with-categorical-data.html#cb24-34" aria-hidden="true" tabindex="-1"></a>TV <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(V5 <span class="sc">~</span> ., <span class="at">data =</span> tv_data)</span>
<span id="cb24-35"><a href="working-with-categorical-data.html#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(TV) <span class="ot">&lt;-</span></span>
<span id="cb24-36"><a href="working-with-categorical-data.html#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">Day =</span> <span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>),</span>
<span id="cb24-37"><a href="working-with-categorical-data.html#cb24-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">Time =</span> <span class="fu">c</span>(<span class="st">&quot;8:00&quot;</span>, <span class="st">&quot;8:15&quot;</span>, <span class="st">&quot;8:30&quot;</span>, <span class="st">&quot;8:45&quot;</span>, <span class="st">&quot;9:00&quot;</span>, <span class="st">&quot;9:15&quot;</span>,</span>
<span id="cb24-38"><a href="working-with-categorical-data.html#cb24-38" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;9:30&quot;</span>, <span class="st">&quot;9:45&quot;</span>, <span class="st">&quot;10:00&quot;</span>, <span class="st">&quot;10:15&quot;</span>, <span class="st">&quot;10:30&quot;</span>),</span>
<span id="cb24-39"><a href="working-with-categorical-data.html#cb24-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">Network =</span> <span class="fu">c</span>(<span class="st">&quot;ABC&quot;</span>, <span class="st">&quot;CBS&quot;</span>, <span class="st">&quot;NBC&quot;</span>, <span class="st">&quot;Fox&quot;</span>, <span class="st">&quot;Other&quot;</span>),</span>
<span id="cb24-40"><a href="working-with-categorical-data.html#cb24-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">State =</span> <span class="fu">c</span>(<span class="st">&quot;Off&quot;</span>, <span class="st">&quot;Switch&quot;</span>, <span class="st">&quot;Persist&quot;</span>))</span>
<span id="cb24-41"><a href="working-with-categorical-data.html#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="working-with-categorical-data.html#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="do">### SECTION </span><span class="al">###</span><span class="do"> 2.9.2. Subsetting and collapsing</span></span>
<span id="cb24-43"><a href="working-with-categorical-data.html#cb24-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-44"><a href="working-with-categorical-data.html#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="do">## subsetting data</span></span>
<span id="cb24-45"><a href="working-with-categorical-data.html#cb24-45" aria-hidden="true" tabindex="-1"></a>TV <span class="ot">&lt;-</span> TV[,,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]     <span class="co"># keep only ABC, CBS, NBC</span></span>
<span id="cb24-46"><a href="working-with-categorical-data.html#cb24-46" aria-hidden="true" tabindex="-1"></a>TV <span class="ot">&lt;-</span> TV[,,,<span class="dv">3</span>]       <span class="co"># keep only Persist -- now a 3 way table</span></span>
<span id="cb24-47"><a href="working-with-categorical-data.html#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="fu">structable</span>(TV)</span>
<span id="cb24-48"><a href="working-with-categorical-data.html#cb24-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-49"><a href="working-with-categorical-data.html#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="do">## collapsing time labels</span></span>
<span id="cb24-50"><a href="working-with-categorical-data.html#cb24-50" aria-hidden="true" tabindex="-1"></a>TV2 <span class="ot">&lt;-</span> <span class="fu">collapse.table</span>(TV,</span>
<span id="cb24-51"><a href="working-with-categorical-data.html#cb24-51" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Time =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;8:00-8:59&quot;</span>, <span class="dv">4</span>),</span>
<span id="cb24-52"><a href="working-with-categorical-data.html#cb24-52" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">rep</span>(<span class="st">&quot;9:00-9:59&quot;</span>, <span class="dv">4</span>),</span>
<span id="cb24-53"><a href="working-with-categorical-data.html#cb24-53" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rep</span>(<span class="st">&quot;10:00-10:44&quot;</span>, <span class="dv">3</span>)))</span>
<span id="cb24-54"><a href="working-with-categorical-data.html#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="fu">structable</span>(Day <span class="sc">~</span> Time <span class="sc">+</span> Network, TV2)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="still-to-do.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/petzi53/cdar/edit/master/02-categorical-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
