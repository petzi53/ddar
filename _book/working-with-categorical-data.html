<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Working with categorical data | Discrete Data Analysis with R</title>
  <meta name="description" content="These are my excerpts and personal notes on the textbook “Discrete Data Analysis with R” by Michael Friendly and David Meyer." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Working with categorical data | Discrete Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are my excerpts and personal notes on the textbook “Discrete Data Analysis with R” by Michael Friendly and David Meyer." />
  <meta name="github-repo" content="petzi53/ddar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Working with categorical data | Discrete Data Analysis with R" />
  
  <meta name="twitter:description" content="These are my excerpts and personal notes on the textbook “Discrete Data Analysis with R” by Michael Friendly and David Meyer." />
  

<meta name="author" content="Peter Baumgartner" />


<meta name="date" content="2022-02-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="still-to-do.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/boxes.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Categorical Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-is-categorical-data"><i class="fa fa-check"></i><b>1.2</b> What is categorical data?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#case-vs.-frequency-form"><i class="fa fa-check"></i><b>1.2.1</b> Case vs. frequency form</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#univariate-bivariate-and-multivariate-data"><i class="fa fa-check"></i><b>1.2.2</b> Univariate, bivariate, and multivariate data</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#explanatory-vs.-response-variables"><i class="fa fa-check"></i><b>1.2.3</b> Explanatory vs. response variables</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#data-analysis-strategies"><i class="fa fa-check"></i><b>1.3</b> Data analysis strategies</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#hypothesis-testing-approaches"><i class="fa fa-check"></i><b>1.3.1</b> Hypothesis testing approaches</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#model-building-approaches"><i class="fa fa-check"></i><b>1.3.2</b> Model building approaches</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#graphical-methods"><i class="fa fa-check"></i><b>1.4</b> Graphical methods</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#visualization-recommendations"><i class="fa fa-check"></i><b>1.4.1</b> Visualization recommendations</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#recommended-packages"><i class="fa fa-check"></i><b>1.4.2</b> Recommended Packages</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#data-und-models-plot"><i class="fa fa-check"></i><b>1.4.3</b> Data und models plot</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#the-80-20-rule"><i class="fa fa-check"></i><b>1.5</b> The 80-20-rule</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#visualization-of-distributions"><i class="fa fa-check"></i><b>1.6</b> Visualization of distributions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html"><i class="fa fa-check"></i><b>2</b> Working with categorical data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#forms-of-categorical-data"><i class="fa fa-check"></i><b>2.2</b> Forms of categorical data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#using-tabulizer"><i class="fa fa-check"></i><b>2.2.1</b> Using tabulizer</a></li>
<li class="chapter" data-level="2.2.2" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#generating-tables"><i class="fa fa-check"></i><b>2.2.2</b> Generating tables</a></li>
<li class="chapter" data-level="2.2.3" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#printing-tables"><i class="fa fa-check"></i><b>2.2.3</b> Printing tables</a></li>
<li class="chapter" data-level="2.2.4" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#collapsing-tables"><i class="fa fa-check"></i><b>2.2.4</b> Collapsing tables</a></li>
<li class="chapter" data-level="2.2.5" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#converting-tables"><i class="fa fa-check"></i><b>2.2.5</b> Converting tables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#a-complex-example"><i class="fa fa-check"></i><b>2.3</b> A complex example</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#dataset-description"><i class="fa fa-check"></i><b>2.3.1</b> Dataset description</a></li>
<li class="chapter" data-level="2.3.2" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#package-dataset"><i class="fa fa-check"></i><b>2.3.2</b> Package dataset</a></li>
<li class="chapter" data-level="2.3.3" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#bv-import"><i class="fa fa-check"></i><b>2.3.3</b> bv-import</a></li>
<li class="chapter" data-level="2.3.4" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#pb-import"><i class="fa fa-check"></i><b>2.3.4</b> pb-import</a></li>
<li class="chapter" data-level="2.3.5" data-path="working-with-categorical-data.html"><a href="working-with-categorical-data.html#summary"><i class="fa fa-check"></i><b>2.3.5</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="still-to-do.html"><a href="still-to-do.html"><i class="fa fa-check"></i><b>3</b> Still to do</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Discrete Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-categorical-data" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Working with categorical data</h1>
<div id="introduction-1" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Introduction</h2>
<p>Creating and manipulating categorical data sets requires some skills and techniques in R beyond those ordinarily used for quantitative data. This chapter illustrates these for the main formats for categorical data: case form, frequency form, and table form.</p>
<blockquote>
<p>The chapter uses many base R commands I am not familiar with. But I believe that most of these commands could be translated to the tidy data approach. The praxis will show if I have the skills for these transformations. This chapter will focus on those commands where I lack knowledge of their functionality.</p>
</blockquote>
<blockquote>
<p>For example, there is a focus on tables, matrices, and arrays – data structures I am not comfortable with. But it should be easy to convert them to data frames or tibbles. There is a similar situation with the graphic command <code>plot()</code>, which should be replaced with <code>ggplot().</code></p>
</blockquote>
</div>
<div id="forms-of-categorical-data" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Forms of categorical data</h2>
<blockquote>
<p>The book distinguishes between case, frequency, and table form. I believe that this differentiation is with the tidy approach not essential anymore. Nowadays, more critical is converting data from wide to long with <code>pivot_longer()</code> and vice versa with <code>pivot_wider()</code>. But again: Practical challenges will be the proof of my assessment.</p>
</blockquote>
<div id="using-tabulizer" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Using tabulizer</h3>
<p>Instead of entering the data manually or importing it from a file or website, I was experimenting with the <strong>{tabulizer}</strong> package. ‘Tabula’ is a Java library designed to extract tables from PDF documents computationally.</p>
<p>Sometimes there are problems with the employment as <strong>{rJava}</strong> is required and complicated to install. But I had it already installed and can’t remember any issues. <strong>{tabulizerjars}</strong> is also necessary. The only purpose of <strong>{tabulizerjars}</strong> is to distribute releases of the ‘Tabula’ Java library to be used with the <strong>{tabulizer}</strong> package. Note that <strong>{tabulizerjars}</strong> itself does not provide any functionality apart from linking to the Java version installed on the system.</p>
<p>See the <a href="https://tabula.technology/">Tabula</a> webpage but first and foremost the <a href="https://docs.ropensci.org/tabulizer/index.html">rOpenSci web page on tabulizer</a> for more details and documentation of all the features.</p>
<p>The primary function is <code>extract_tables()</code> with several parameters, for instance, the page for the table to be extracted. But in my case, providing the page number pulled another table at the beginning of the page. Therefore I had to use the interactive <code>locate_areas()</code> function. The program stops and displays a mini picture of the desired PDF page to select the area with the table.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="working-with-categorical-data.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href="working-with-categorical-data.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizer)</span>
<span id="cb5-3"><a href="working-with-categorical-data.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizerjars)</span>
<span id="cb5-4"><a href="working-with-categorical-data.html#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="working-with-categorical-data.html#cb5-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(<span class="st">&quot;test-data/DDAR.pdf&quot;</span>)</span>
<span id="cb5-6"><a href="working-with-categorical-data.html#cb5-6" aria-hidden="true" tabindex="-1"></a>tab_area <span class="ot">&lt;-</span> <span class="fu">locate_areas</span>(<span class="at">file =</span> f, <span class="at">page =</span> <span class="dv">53</span>)</span>
<span id="cb5-7"><a href="working-with-categorical-data.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(tab_area, <span class="st">&quot;test-data/example-tab-area&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="working-with-categorical-data.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-2"><a href="working-with-categorical-data.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span></span>
<span id="cb6-3"><a href="working-with-categorical-data.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4</span></span>
<span id="cb6-4"><a href="working-with-categorical-data.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ✓ tibble  3.1.6     ✓ dplyr   1.0.7</span></span>
<span id="cb6-5"><a href="working-with-categorical-data.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ✓ tidyr   1.1.4     ✓ stringr 1.4.0</span></span>
<span id="cb6-6"><a href="working-with-categorical-data.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ✓ readr   2.1.1     ✓ forcats 0.5.1</span></span>
<span id="cb6-7"><a href="working-with-categorical-data.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span id="cb6-8"><a href="working-with-categorical-data.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="do">## x dplyr::filter() masks stats::filter()</span></span>
<span id="cb6-9"><a href="working-with-categorical-data.html#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="do">## x dplyr::lag()    masks stats::lag()</span></span>
<span id="cb6-10"><a href="working-with-categorical-data.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizer)</span>
<span id="cb6-11"><a href="working-with-categorical-data.html#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizerjars)</span>
<span id="cb6-12"><a href="working-with-categorical-data.html#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="working-with-categorical-data.html#cb6-13" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">normalizePath</span>(<span class="st">&quot;test-data/DDAR.pdf&quot;</span>)</span>
<span id="cb6-14"><a href="working-with-categorical-data.html#cb6-14" aria-hidden="true" tabindex="-1"></a>tab_area <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;test-data/example-tab-area&quot;</span>)</span>
<span id="cb6-15"><a href="working-with-categorical-data.html#cb6-15" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">extract_tables</span>(<span class="at">file =</span> f,</span>
<span id="cb6-16"><a href="working-with-categorical-data.html#cb6-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">page =</span> <span class="dv">53</span>, </span>
<span id="cb6-17"><a href="working-with-categorical-data.html#cb6-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">area =</span> tab_area,</span>
<span id="cb6-18"><a href="working-with-categorical-data.html#cb6-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">guess =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-19"><a href="working-with-categorical-data.html#cb6-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">output =</span> <span class="st">&quot;data.frame&quot;</span>)</span>
<span id="cb6-20"><a href="working-with-categorical-data.html#cb6-20" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(df[[<span class="dv">1</span>]])</span>
<span id="cb6-21"><a href="working-with-categorical-data.html#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df[<span class="dv">1</span>, ])</span>
<span id="cb6-22"><a href="working-with-categorical-data.html#cb6-22" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb6-23"><a href="working-with-categorical-data.html#cb6-23" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">names_to =</span> <span class="st">&quot;party&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb6-24"><a href="working-with-categorical-data.html#cb6-24" aria-hidden="true" tabindex="-1"></a>df</span>
<span id="cb6-25"><a href="working-with-categorical-data.html#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 6 × 3</span></span>
<span id="cb6-26"><a href="working-with-categorical-data.html#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   sex    party count</span></span>
<span id="cb6-27"><a href="working-with-categorical-data.html#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;</span></span>
<span id="cb6-28"><a href="working-with-categorical-data.html#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 female dem   279  </span></span>
<span id="cb6-29"><a href="working-with-categorical-data.html#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 female indep 73   </span></span>
<span id="cb6-30"><a href="working-with-categorical-data.html#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 female rep   225  </span></span>
<span id="cb6-31"><a href="working-with-categorical-data.html#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 male   dem   165  </span></span>
<span id="cb6-32"><a href="working-with-categorical-data.html#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 male   indep 47   </span></span>
<span id="cb6-33"><a href="working-with-categorical-data.html#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 male   rep   191</span></span></code></pre></div>
</div>
<div id="generating-tables" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Generating tables</h3>
<p>With data in case form or frequency form, you can generate frequency tables from factor variables in data frames using the <code>table()</code> function; for tables of proportions, use the <code>prop.table()</code> function, and for marginal frequencies (summing over some variables) use <code>margin.table()</code>.</p>
<div class="todobox">
<blockquote>
<p>I have to look up other books using modern approaches to see what functions they use, e.g., <a href="https://moderndive.netlify.app/index.html">ModernDive</a> (Statistical Inference via Data Science – A ModernDive into R and the Tidyverse). I believe the <strong>{janitor}</strong> packages may be helpful for <code>prop.table()</code> and <code>margin.table()</code> functionalities.</p>
</blockquote>
</div>
</div>
<div id="printing-tables" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Printing tables</h3>
<p>For 3-way and larger tables, the functions <code>ftable()</code> (in the <strong>{stats}</strong> package) and <code>structable()</code> (in <strong>{vcd}</strong>) provide a convenient and flexible tabular display in a “flat” (2-way) format.</p>
</div>
<div id="collapsing-tables" class="section level3" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Collapsing tables</h3>
<p>It sometimes happens that we have a data set with more variables or factors than we want to analyze. The book recommends <code>aggregate()</code> in {stats}, <code>margin.table()</code> resp. <code>marginSums()</code>, <code>apply()</code> (both in <strong>{base}</strong>), and <code>collapse.table()</code> from the <strong>{vcdExtra}</strong> package.</p>
<div class="todobox">
<blockquote>
<p>Again I have to find equivalents. I believe that the modern approach works with <strong>{dplyr}</strong>, <strong>{tidyr}</strong>, <strong>{purrr}</strong>, <strong>{tibble}</strong> and <strong>{forcats}</strong> (all provided by the <strong>{<a href="https://tidyverse.tidyverse.org/">tidyverse</a>}</strong> package suite.)</p>
</blockquote>
</div>
</div>
<div id="converting-tables" class="section level3" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> Converting tables</h3>
<p>A given contingency table can be represented equivalently in case, frequency, and table forms. However, some R functions were designed for one particular representation. Therefore converting tables from one structure to another is critical.</p>
<p>In addition to the already mentioned functions of <code>table()</code>, <code>xtabs()</code> and <code>as.data.frame()</code> the book references the <code>expand.dft()</code> function in <strong>{vcdExtra}</strong>. For producing a LateX table the <strong>{xtable}</strong> package is recommended.</p>
<blockquote>
<p>Am not sure if the packages of the <strong>{tidyverse}</strong> meta-package solve these conversion problems. But to know more about the requirements, I will print the output from different table commands. I will not use one of the sophisticated table formating and print commands but will apply just the implemented printing method of the referenced table command.</p>
</blockquote>
<p>I am going to use for this task the <code>UCBAdmissions</code> data from the base <strong>{datasets}</strong> package. For a shorter later reference, I will copy it to <code>UCB.</code></p>
<div id="table" class="section level4" number="2.2.5.1">
<h4><span class="header-section-number">2.2.5.1</span> table</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="working-with-categorical-data.html#cb7-1" aria-hidden="true" tabindex="-1"></a>(UCB <span class="ot">&lt;-</span> UCBAdmissions) <span class="co"># same as:  xtabs(Freq ~ ., data = UCB)</span></span>
<span id="cb7-2"><a href="working-with-categorical-data.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Dept = A</span></span>
<span id="cb7-3"><a href="working-with-categorical-data.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-4"><a href="working-with-categorical-data.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">##           Gender</span></span>
<span id="cb7-5"><a href="working-with-categorical-data.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Admit      Male Female</span></span>
<span id="cb7-6"><a href="working-with-categorical-data.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Admitted  512     89</span></span>
<span id="cb7-7"><a href="working-with-categorical-data.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Rejected  313     19</span></span>
<span id="cb7-8"><a href="working-with-categorical-data.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-9"><a href="working-with-categorical-data.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Dept = B</span></span>
<span id="cb7-10"><a href="working-with-categorical-data.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-11"><a href="working-with-categorical-data.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">##           Gender</span></span>
<span id="cb7-12"><a href="working-with-categorical-data.html#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Admit      Male Female</span></span>
<span id="cb7-13"><a href="working-with-categorical-data.html#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   Admitted  353     17</span></span>
<span id="cb7-14"><a href="working-with-categorical-data.html#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   Rejected  207      8</span></span>
<span id="cb7-15"><a href="working-with-categorical-data.html#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-16"><a href="working-with-categorical-data.html#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Dept = C</span></span>
<span id="cb7-17"><a href="working-with-categorical-data.html#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-18"><a href="working-with-categorical-data.html#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="do">##           Gender</span></span>
<span id="cb7-19"><a href="working-with-categorical-data.html#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Admit      Male Female</span></span>
<span id="cb7-20"><a href="working-with-categorical-data.html#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   Admitted  120    202</span></span>
<span id="cb7-21"><a href="working-with-categorical-data.html#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   Rejected  205    391</span></span>
<span id="cb7-22"><a href="working-with-categorical-data.html#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-23"><a href="working-with-categorical-data.html#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Dept = D</span></span>
<span id="cb7-24"><a href="working-with-categorical-data.html#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-25"><a href="working-with-categorical-data.html#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="do">##           Gender</span></span>
<span id="cb7-26"><a href="working-with-categorical-data.html#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Admit      Male Female</span></span>
<span id="cb7-27"><a href="working-with-categorical-data.html#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   Admitted  138    131</span></span>
<span id="cb7-28"><a href="working-with-categorical-data.html#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   Rejected  279    244</span></span>
<span id="cb7-29"><a href="working-with-categorical-data.html#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-30"><a href="working-with-categorical-data.html#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Dept = E</span></span>
<span id="cb7-31"><a href="working-with-categorical-data.html#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-32"><a href="working-with-categorical-data.html#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="do">##           Gender</span></span>
<span id="cb7-33"><a href="working-with-categorical-data.html#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Admit      Male Female</span></span>
<span id="cb7-34"><a href="working-with-categorical-data.html#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="do">##   Admitted   53     94</span></span>
<span id="cb7-35"><a href="working-with-categorical-data.html#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="do">##   Rejected  138    299</span></span>
<span id="cb7-36"><a href="working-with-categorical-data.html#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-37"><a href="working-with-categorical-data.html#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Dept = F</span></span>
<span id="cb7-38"><a href="working-with-categorical-data.html#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-39"><a href="working-with-categorical-data.html#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="do">##           Gender</span></span>
<span id="cb7-40"><a href="working-with-categorical-data.html#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Admit      Male Female</span></span>
<span id="cb7-41"><a href="working-with-categorical-data.html#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="do">##   Admitted   22     24</span></span>
<span id="cb7-42"><a href="working-with-categorical-data.html#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="do">##   Rejected  351    317</span></span></code></pre></div>
</div>
<div id="ftable" class="section level4" number="2.2.5.2">
<h4><span class="header-section-number">2.2.5.2</span> ftable()</h4>
<p><code>ftable()</code> creates ‘flat’ contingency tables. They contain the counts of each combination of the levels of the variables (factors) involved. This information is then re-arranged as a matrix whose rows and columns correspond to unique combinations of the levels of the row and column variables (as specified by <code>row.vars</code> and <code>col.vars</code>, respectively).</p>
<p>These combinations are created by looping over the variables in reverse order so that levels of the left-most variable vary the slowest. Displaying a contingency table in this flat matrix form is often preferable to showing it as a higher-dimensional array.</p>
<p><code>ftable()</code> returns an object of class “ftable,” which is a matrix with counts of each combination of the levels of variables with information on the names and levels of the (row and columns) variables stored as attributes “row.vars” and “col.vars.”</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="working-with-categorical-data.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(UCB, <span class="at">row.vars =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb8-2"><a href="working-with-categorical-data.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Dept   A   B   C   D   E   F</span></span>
<span id="cb8-3"><a href="working-with-categorical-data.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Admit    Gender                             </span></span>
<span id="cb8-4"><a href="working-with-categorical-data.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Admitted Male        512 353 120 138  53  22</span></span>
<span id="cb8-5"><a href="working-with-categorical-data.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">##          Female       89  17 202 131  94  24</span></span>
<span id="cb8-6"><a href="working-with-categorical-data.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Rejected Male        313 207 205 279 138 351</span></span>
<span id="cb8-7"><a href="working-with-categorical-data.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          Female       19   8 391 244 299 317</span></span></code></pre></div>
</div>
<div id="ftable-with-formula" class="section level4" number="2.2.5.3">
<h4><span class="header-section-number">2.2.5.3</span> ftable() with formula</h4>
<p>The left and right-hand sides of the formula specify the column and row variables, respectively, of the flat contingency table to be created. Only the <code>+</code> operator is allowed for combining the variables. A <code>.</code> may be used once in the formula to indicate the inclusion of all the remaining variables.</p>
<p>If data is an object of class “table” or an array with more than 2 dimensions, it is taken as a contingency table, and hence all entries should be nonnegative. Otherwise, if it is not a flat contingency table (i.e., an object of class “ftable”), it should be a data frame or matrix, list, or environment containing the variables to be cross-tabulated.</p>
<p>The result is a flat contingency table that contains the counts of each combination of the levels of the variables, collapsed into a matrix for suitably displaying the counts.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="working-with-categorical-data.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(Admit <span class="sc">+</span> Gender <span class="sc">~</span> Dept, <span class="at">data =</span> UCB)</span>
<span id="cb9-2"><a href="working-with-categorical-data.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">##      Admit  Admitted        Rejected       </span></span>
<span id="cb9-3"><a href="working-with-categorical-data.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">##      Gender     Male Female     Male Female</span></span>
<span id="cb9-4"><a href="working-with-categorical-data.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Dept                                       </span></span>
<span id="cb9-5"><a href="working-with-categorical-data.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="do">## A                512     89      313     19</span></span>
<span id="cb9-6"><a href="working-with-categorical-data.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="do">## B                353     17      207      8</span></span>
<span id="cb9-7"><a href="working-with-categorical-data.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="do">## C                120    202      205    391</span></span>
<span id="cb9-8"><a href="working-with-categorical-data.html#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="do">## D                138    131      279    244</span></span>
<span id="cb9-9"><a href="working-with-categorical-data.html#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="do">## E                 53     94      138    299</span></span>
<span id="cb9-10"><a href="working-with-categorical-data.html#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="do">## F                 22     24      351    317</span></span></code></pre></div>
</div>
<div id="xtabs" class="section level4" number="2.2.5.4">
<h4><span class="header-section-number">2.2.5.4</span> xtabs()</h4>
<p>The <code>xtabs()</code> function allows you to create cross-tabulations of data using formula-style input. This typically works with case- or frequency-form data supplied in a data frame or a matrix. The result is a contingency table in array format, whose dimensions are determined by the formula’s terms on the right side.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="working-with-categorical-data.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(Freq <span class="sc">~</span> Gender <span class="sc">+</span> Admit, <span class="at">data =</span> UCB)</span>
<span id="cb10-2"><a href="working-with-categorical-data.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="do">##         Admit</span></span>
<span id="cb10-3"><a href="working-with-categorical-data.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Gender   Admitted Rejected</span></span>
<span id="cb10-4"><a href="working-with-categorical-data.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="do">##   Male       1198     1493</span></span>
<span id="cb10-5"><a href="working-with-categorical-data.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="do">##   Female      557     1278</span></span></code></pre></div>
</div>
<div id="structable" class="section level4" number="2.2.5.5">
<h4><span class="header-section-number">2.2.5.5</span> structable()</h4>
<p><code>structable()</code> produces a ‘flat’ representation of a high-dimensional contingency table constructed by recursive splits (similar to the construction of mosaic displays). The result is a textual representation of mosaic displays and thus ‘flat’ contingency tables. The formula interface is similar to <code>ftable()</code> but also accepts the mosaic-like formula interface (empty left-hand side).</p>
<p>The function results in an object of class “structable,” inheriting from class “ftable,” with the splitting information (“split_vertical”) as an additional attribute.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="working-with-categorical-data.html#cb11-1" aria-hidden="true" tabindex="-1"></a>vcd<span class="sc">::</span><span class="fu">structable</span>(UCB)</span>
<span id="cb11-2"><a href="working-with-categorical-data.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">##               Gender Male Female</span></span>
<span id="cb11-3"><a href="working-with-categorical-data.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Admit    Dept                   </span></span>
<span id="cb11-4"><a href="working-with-categorical-data.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Admitted A            512     89</span></span>
<span id="cb11-5"><a href="working-with-categorical-data.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">##          B            353     17</span></span>
<span id="cb11-6"><a href="working-with-categorical-data.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          C            120    202</span></span>
<span id="cb11-7"><a href="working-with-categorical-data.html#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          D            138    131</span></span>
<span id="cb11-8"><a href="working-with-categorical-data.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="do">##          E             53     94</span></span>
<span id="cb11-9"><a href="working-with-categorical-data.html#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="do">##          F             22     24</span></span>
<span id="cb11-10"><a href="working-with-categorical-data.html#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Rejected A            313     19</span></span>
<span id="cb11-11"><a href="working-with-categorical-data.html#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="do">##          B            207      8</span></span>
<span id="cb11-12"><a href="working-with-categorical-data.html#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="do">##          C            205    391</span></span>
<span id="cb11-13"><a href="working-with-categorical-data.html#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="do">##          D            279    244</span></span>
<span id="cb11-14"><a href="working-with-categorical-data.html#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="do">##          E            138    299</span></span>
<span id="cb11-15"><a href="working-with-categorical-data.html#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="do">##          F            351    317</span></span></code></pre></div>
</div>
<div id="tibble" class="section level4" number="2.2.5.6">
<h4><span class="header-section-number">2.2.5.6</span> tibble()</h4>
<blockquote>
<p>The text of this section is derived from the help files and vignette of the <strong>{tibble}</strong> packages.</p>
</blockquote>
<p><code>tibble()</code> is a nice way to create data frames. A tibble is a data frame with class <code>tbl_df</code>, a subclass of <code>data.frame</code>, designed to have different default behavior. Tibble is the central data structure for the set of packages known as the <strong>{<a href="https://www.tidyverse.org/">tidyverse</a>}</strong>.</p>
<p>To complement <code>tibble()</code>, the <strong>{tibble}</strong> package provides <code>as_tibble()</code> to coerce an existing object, such as a data frame or matrix, into tibbles . A tibble encapsulates best practices for data frames:</p>
<ul>
<li>It never changes an input’s type (i.e., no more <code>stringsAsFactors = FALSE</code>!). This makes it easier to use with list columns. List-columns are often created by <code>tidyr::nest()</code>, but they can be useful to create by hand.</li>
<li>It never adjusts the names of variables.</li>
<li>It evaluates its arguments lazily and sequentially.</li>
<li>It never uses <code>row.names()</code>. The whole point of tidy data is to store variables in a consistent way. So it never stores a variable as a special attribute.</li>
<li>It only recycles vectors of length 1. This is because recycling vectors of greater lengths are a frequent source of bugs.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="working-with-categorical-data.html#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">as_tibble</span>(UCB))</span>
<span id="cb12-2"><a href="working-with-categorical-data.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 24 × 4</span></span>
<span id="cb12-3"><a href="working-with-categorical-data.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="do">##    Admit    Gender Dept      n</span></span>
<span id="cb12-4"><a href="working-with-categorical-data.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;</span></span>
<span id="cb12-5"><a href="working-with-categorical-data.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 Admitted Male   A       512</span></span>
<span id="cb12-6"><a href="working-with-categorical-data.html#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 Rejected Male   A       313</span></span>
<span id="cb12-7"><a href="working-with-categorical-data.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 Admitted Female A        89</span></span>
<span id="cb12-8"><a href="working-with-categorical-data.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 Rejected Female A        19</span></span>
<span id="cb12-9"><a href="working-with-categorical-data.html#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 Admitted Male   B       353</span></span>
<span id="cb12-10"><a href="working-with-categorical-data.html#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 Rejected Male   B       207</span></span>
<span id="cb12-11"><a href="working-with-categorical-data.html#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 Admitted Female B        17</span></span>
<span id="cb12-12"><a href="working-with-categorical-data.html#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 Rejected Female B         8</span></span>
<span id="cb12-13"><a href="working-with-categorical-data.html#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 Admitted Male   C       120</span></span>
<span id="cb12-14"><a href="working-with-categorical-data.html#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 Rejected Male   C       205</span></span>
<span id="cb12-15"><a href="working-with-categorical-data.html#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # … with 14 more rows</span></span></code></pre></div>
<blockquote>
<p>It seems to me that all the complex discussion about different table formats is now outdated with the <strong>{tibble}</strong> data structure from the <strong>{tidyverse}</strong> approach. The same is true with <strong>{dplyr}</strong> concerning subsetting, filtering, or other transforming activities. This is especially important for manipulating factor levels where the <strong>{forcats}</strong> packages replace all the different functions for aggregating and collapsing. But to learn &amp; decide what code is necessary, I would need the actual problem. Therefore I just skimmed chapter 2.</p>
</blockquote>
</div>
</div>
</div>
<div id="a-complex-example" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> A complex example</h2>
<blockquote>
<p>A good conversion exercise is the following complex example on TV viewing data. I will check if I can provide the necessary R code to fulfill the requirements. I have to inspect it line per line and replace it with working code from the newer tidyverse approach. To see the difference, I will keep the old code and describe the various data-wrangling actions.</p>
</blockquote>
<div id="dataset-description" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Dataset description</h3>
<p>Are you ready for a more complicated example that puts together various skills developed in this chapter? These skills are</p>
<ol style="list-style-type: lower-alpha">
<li>reading raw data,</li>
<li>creating tables,</li>
<li>assigning level names to factors and</li>
<li>collapsing levels or variables for use in the analysis.</li>
</ol>
<p>To illustrate these steps, we use the dataset <code>tv.dat</code>, supplied with the initial implementation of mosaic displays. They were derived from an early, compelling example of mosaic displays that illustrated the method with data on a large sample of TV viewers whose behavior had been recorded for the Neilsen ratings. This data set contains sample television audience data from Neilsen Media Research for the week starting November 6, 1995.</p>
<p>The data file, <code>tv.dat</code>, is stored in frequency form with 825 rows and 5 columns. There is no header line in the file, so when we use <code>read.table()</code> below, the variables will be named <code>V1 – V5</code>. This data represents a 4-way table of size <span class="math inline">\(5 × 11 × 5 × 3 = 825\)</span> where the table variables are <code>V1 – V4</code>, and the cell frequency is read as <code>V5</code>.</p>
<p>The table variables are:</p>
<ul>
<li><code>V1</code> — values <span class="math inline">\(1:5\)</span> correspond to the days Monday–Friday;</li>
<li><code>V2</code> — values <span class="math inline">\(1:11\)</span> correspond to the quarter-hour times <span class="math inline">\(8:00\)</span> pm through <span class="math inline">\(10:30\)</span> pm;</li>
<li><code>V3</code> — values <span class="math inline">\(1:5\)</span> correspond to ABC, CBS, NBC, Fox, and non-network choices;</li>
<li><code>V4</code> — values <span class="math inline">\(1:3\)</span> correspond to transition states: turn the television Off, Switch channels, or Persist in viewing the current channel.</li>
</ul>
</div>
<div id="package-dataset" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Package dataset</h3>
<p>There is a <code>TV</code> dataset in the <strong>{vcdExtra}</strong> package. To load it would be the easiest way to get the data. In that case, you would not have to worry about data transformation because the dataset is already in the desired form.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="working-with-categorical-data.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vcdExtra)</span>
<span id="cb13-2"><a href="working-with-categorical-data.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: vcd</span></span>
<span id="cb13-3"><a href="working-with-categorical-data.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: grid</span></span>
<span id="cb13-4"><a href="working-with-categorical-data.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: gnm</span></span>
<span id="cb13-5"><a href="working-with-categorical-data.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-6"><a href="working-with-categorical-data.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;vcdExtra&#39;</span></span>
<span id="cb13-7"><a href="working-with-categorical-data.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The following object is masked from &#39;package:dplyr&#39;:</span></span>
<span id="cb13-8"><a href="working-with-categorical-data.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-9"><a href="working-with-categorical-data.html#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     summarise</span></span>
<span id="cb13-10"><a href="working-with-categorical-data.html#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="working-with-categorical-data.html#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(TV)  <span class="co"># the most straightforward way, does not need data wrangling</span></span>
<span id="cb13-12"><a href="working-with-categorical-data.html#cb13-12" aria-hidden="true" tabindex="-1"></a>TV</span>
<span id="cb13-13"><a href="working-with-categorical-data.html#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Network = ABC</span></span>
<span id="cb13-14"><a href="working-with-categorical-data.html#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-15"><a href="working-with-categorical-data.html#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="do">##            Time</span></span>
<span id="cb13-16"><a href="working-with-categorical-data.html#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Day         8:00 8:15 8:30 8:45 9:00 9:15 9:30 9:45 10:00 10:15 10:30</span></span>
<span id="cb13-17"><a href="working-with-categorical-data.html#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   Monday     146  151  156   83  325  350  386  340   352   280   278</span></span>
<span id="cb13-18"><a href="working-with-categorical-data.html#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   Tuesday    244  181  231  205  385  283  345  192   329   351   364</span></span>
<span id="cb13-19"><a href="working-with-categorical-data.html#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   Wednesday  233  161  194  156  339  264  279  140   237   228   203</span></span>
<span id="cb13-20"><a href="working-with-categorical-data.html#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   Thursday   174  183  197  181  187  198  211   86   110   122   117</span></span>
<span id="cb13-21"><a href="working-with-categorical-data.html#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   Friday     294  281  305  239  278  246  245  138   246   232   233</span></span>
<span id="cb13-22"><a href="working-with-categorical-data.html#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-23"><a href="working-with-categorical-data.html#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Network = CBS</span></span>
<span id="cb13-24"><a href="working-with-categorical-data.html#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-25"><a href="working-with-categorical-data.html#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="do">##            Time</span></span>
<span id="cb13-26"><a href="working-with-categorical-data.html#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Day         8:00 8:15 8:30 8:45 9:00 9:15 9:30 9:45 10:00 10:15 10:30</span></span>
<span id="cb13-27"><a href="working-with-categorical-data.html#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   Monday     337  293  304  233  311  251  241  164   252   265   272</span></span>
<span id="cb13-28"><a href="working-with-categorical-data.html#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   Tuesday    173  180  184  109  218  235  256  250   274   263   261</span></span>
<span id="cb13-29"><a href="working-with-categorical-data.html#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="do">##   Wednesday  158  126  207   59   98  103  122   86   109   105   110</span></span>
<span id="cb13-30"><a href="working-with-categorical-data.html#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="do">##   Thursday   196  185  195  104  106  116  116   47   102    84    84</span></span>
<span id="cb13-31"><a href="working-with-categorical-data.html#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="do">##   Friday     130  144  154   81  129  153  136  126   138   136   152</span></span>
<span id="cb13-32"><a href="working-with-categorical-data.html#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-33"><a href="working-with-categorical-data.html#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="do">## , , Network = NBC</span></span>
<span id="cb13-34"><a href="working-with-categorical-data.html#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb13-35"><a href="working-with-categorical-data.html#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="do">##            Time</span></span>
<span id="cb13-36"><a href="working-with-categorical-data.html#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Day         8:00 8:15 8:30 8:45 9:00 9:15 9:30 9:45 10:00 10:15 10:30</span></span>
<span id="cb13-37"><a href="working-with-categorical-data.html#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="do">##   Monday     263  219  236  140  226  235  239  246   279   263   283</span></span>
<span id="cb13-38"><a href="working-with-categorical-data.html#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="do">##   Tuesday    315  254  280  241  370  214  195  111   188   190   210</span></span>
<span id="cb13-39"><a href="working-with-categorical-data.html#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="do">##   Wednesday  134  146  166   66  194  230  264  143   274   289   306</span></span>
<span id="cb13-40"><a href="working-with-categorical-data.html#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="do">##   Thursday   515  463  472  477  590  473  446  349   649   705   747</span></span>
<span id="cb13-41"><a href="working-with-categorical-data.html#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="do">##   Friday     195  220  248  160  172  164  169   85   183   198   204</span></span>
<span id="cb13-42"><a href="working-with-categorical-data.html#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(TV)</span>
<span id="cb13-43"><a href="working-with-categorical-data.html#cb13-43" aria-hidden="true" tabindex="-1"></a><span class="do">##  int [1:5, 1:11, 1:3] 146 244 233 174 294 151 181 161 183 281 ...</span></span>
<span id="cb13-44"><a href="working-with-categorical-data.html#cb13-44" aria-hidden="true" tabindex="-1"></a><span class="do">##  - attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb13-45"><a href="working-with-categorical-data.html#cb13-45" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ Day    : chr [1:5] &quot;Monday&quot; &quot;Tuesday&quot; &quot;Wednesday&quot; &quot;Thursday&quot; ...</span></span>
<span id="cb13-46"><a href="working-with-categorical-data.html#cb13-46" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ Time   : chr [1:11] &quot;8:00&quot; &quot;8:15&quot; &quot;8:30&quot; &quot;8:45&quot; ...</span></span>
<span id="cb13-47"><a href="working-with-categorical-data.html#cb13-47" aria-hidden="true" tabindex="-1"></a><span class="do">##   ..$ Network: chr [1:3] &quot;ABC&quot; &quot;CBS&quot; &quot;NBC&quot;</span></span></code></pre></div>
<p>‘TV’ data set comprises a 5 x 11 x 3 contingency table. But this is not the original dataset described under the subsection <a href="working-with-categorical-data.html#package-dataset">2.3.2</a>.</p>
<p>“The original data, tv.dat, contains two additional networks:”Fox” and “Other,” with small frequencies. These levels were removed in the current version. There is also a fourth factor, transition State transition (turn the television Off, Switch channels, or Persist in viewing the current channel). The TV data here includes only the Persist observations.” (From the TV <strong>{vcdExtra}</strong> help file.)</p>
<p>We, therefore, will go the hard way and import the <code>tv.dat</code> file as mentioned in the book. But viewing the above dataset gives you a good impression of how the data should look at the end of the data wrangling process.</p>
<div class="bluebox">
<p>The <strong>b</strong>ook <strong>v</strong>ersion contains<code>bv-</code> in the chunk- and variable names. In contrast to my own version, which has my initials <code>pb-</code> in their designations.</p>
</div>
</div>
<div id="bv-import" class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> bv-import</h3>
<p><strong>1. Step</strong>: The provided R code in the <a href="http://ddar.datavis.ca/pages/Rcode/ch02.R">ch02.R file</a> does not work. The book referenced the file <code>tv.dat</code> to the <code>doc/extdata</code> directory of <strong>{vcdExtra}</strong>. On my (macOS) installation <code>tv.dat</code> is indeed inside <code>extdata</code>, but <code>extdata</code> is not a subdirectory of <code>doc</code>.</p>
<p>You can also use the RStudio interactive menu: “File -&gt; Import Dataset -&gt; From text (base) ….”</p>
<p><strong>2. Step</strong>: In the next step we use <code>xtabs()</code> to do the cross-tabulation, using <span class="math inline">\(V5\)</span> as the frequency variable. <code>xtabs()</code> uses a formula interface as demonstrated in section <a href="working-with-categorical-data.html#xtabs">2.2.5.4</a>.</p>
<p><strong>3. Step</strong>: The third step attaches names to the factors. There is no assignment necessary, but the list has to be ordered.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="working-with-categorical-data.html#cb14-1" aria-hidden="true" tabindex="-1"></a>tv_bv <span class="ot">&lt;-</span></span>
<span id="cb14-2"><a href="working-with-categorical-data.html#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read.table</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;tv.dat&quot;</span>,   <span class="co"># without &quot;doc&quot; directory</span></span>
<span id="cb14-3"><a href="working-with-categorical-data.html#cb14-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">package =</span> <span class="st">&quot;vcdExtra&quot;</span>))</span>
<span id="cb14-4"><a href="working-with-categorical-data.html#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="working-with-categorical-data.html#cb14-5" aria-hidden="true" tabindex="-1"></a>tv_bv <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(V5 <span class="sc">~</span> ., <span class="at">data =</span> tv_bv)</span>
<span id="cb14-6"><a href="working-with-categorical-data.html#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="working-with-categorical-data.html#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(tv_bv) <span class="ot">&lt;-</span></span>
<span id="cb14-8"><a href="working-with-categorical-data.html#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb14-9"><a href="working-with-categorical-data.html#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">Day =</span> <span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>), </span>
<span id="cb14-10"><a href="working-with-categorical-data.html#cb14-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">Time =</span> <span class="fu">c</span>(</span>
<span id="cb14-11"><a href="working-with-categorical-data.html#cb14-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;8:00&quot;</span>,</span>
<span id="cb14-12"><a href="working-with-categorical-data.html#cb14-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;8:15&quot;</span>,</span>
<span id="cb14-13"><a href="working-with-categorical-data.html#cb14-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;8:30&quot;</span>,</span>
<span id="cb14-14"><a href="working-with-categorical-data.html#cb14-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;8:45&quot;</span>,</span>
<span id="cb14-15"><a href="working-with-categorical-data.html#cb14-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;9:00&quot;</span>,</span>
<span id="cb14-16"><a href="working-with-categorical-data.html#cb14-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;9:15&quot;</span>,</span>
<span id="cb14-17"><a href="working-with-categorical-data.html#cb14-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;9:30&quot;</span>,</span>
<span id="cb14-18"><a href="working-with-categorical-data.html#cb14-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;9:45&quot;</span>,</span>
<span id="cb14-19"><a href="working-with-categorical-data.html#cb14-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;10:00&quot;</span>,</span>
<span id="cb14-20"><a href="working-with-categorical-data.html#cb14-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;10:15&quot;</span>,</span>
<span id="cb14-21"><a href="working-with-categorical-data.html#cb14-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;10:30&quot;</span></span>
<span id="cb14-22"><a href="working-with-categorical-data.html#cb14-22" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb14-23"><a href="working-with-categorical-data.html#cb14-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">Network =</span> <span class="fu">c</span>(<span class="st">&quot;ABC&quot;</span>, <span class="st">&quot;CBS&quot;</span>, <span class="st">&quot;NBC&quot;</span>, <span class="st">&quot;Fox&quot;</span>, <span class="st">&quot;Other&quot;</span>),</span>
<span id="cb14-24"><a href="working-with-categorical-data.html#cb14-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">c</span>(<span class="st">&quot;Off&quot;</span>, <span class="st">&quot;Switch&quot;</span>, <span class="st">&quot;Persist&quot;</span>)</span>
<span id="cb14-25"><a href="working-with-categorical-data.html#cb14-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-26"><a href="working-with-categorical-data.html#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="working-with-categorical-data.html#cb14-27" aria-hidden="true" tabindex="-1"></a>tv_bv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tv_bv, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">5</span>, <span class="dv">3</span>))</span>
<span id="cb14-28"><a href="working-with-categorical-data.html#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="working-with-categorical-data.html#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tv_bv)</span>
<span id="cb14-30"><a href="working-with-categorical-data.html#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    825 obs. of  5 variables:</span></span>
<span id="cb14-31"><a href="working-with-categorical-data.html#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Day    : Factor w/ 5 levels &quot;Mon&quot;,&quot;Tue&quot;,&quot;Wed&quot;,..: 1 2 3 4 5 1 2 3 4 5 ...</span></span>
<span id="cb14-32"><a href="working-with-categorical-data.html#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Time   : Factor w/ 11 levels &quot;8:00&quot;,&quot;8:15&quot;,..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span id="cb14-33"><a href="working-with-categorical-data.html#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Network: Factor w/ 5 levels &quot;ABC&quot;,&quot;CBS&quot;,&quot;NBC&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb14-34"><a href="working-with-categorical-data.html#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ State  : Factor w/ 3 levels &quot;Off&quot;,&quot;Switch&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb14-35"><a href="working-with-categorical-data.html#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ Freq   : int  6 18 6 2 11 6 29 25 17 29 ...</span></span>
<span id="cb14-36"><a href="working-with-categorical-data.html#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tv_bv, <span class="dv">5</span>)</span>
<span id="cb14-37"><a href="working-with-categorical-data.html#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="do">##   Day Time Network State Freq</span></span>
<span id="cb14-38"><a href="working-with-categorical-data.html#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Mon 8:00     ABC   Off    6</span></span>
<span id="cb14-39"><a href="working-with-categorical-data.html#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Tue 8:00     ABC   Off   18</span></span>
<span id="cb14-40"><a href="working-with-categorical-data.html#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Wed 8:00     ABC   Off    6</span></span>
<span id="cb14-41"><a href="working-with-categorical-data.html#cb14-41" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Thu 8:00     ABC   Off    2</span></span>
<span id="cb14-42"><a href="working-with-categorical-data.html#cb14-42" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 Fri 8:00     ABC   Off   11</span></span></code></pre></div>
</div>
<div id="pb-import" class="section level3" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> pb-import</h3>
<p><strong>1. Step</strong>: At first I tried to use the <code>read_table()</code> function from the <strong>{readr}</strong> package to import the data into a <a href="https://tibble.tidyverse.org/">tibble</a>. But this didn’t work, as I always got an additional column of logical type full with <code>NA's, and the first row was not imported. After I changed to the free width format</code>read_fwf()` of the same package, it worked. In the same step, I named the columns and defined the data type of the variables.</p>
<p>The import result is a tibble, a modern take on data frames. It encapsulates best practices for data frames and drops the features that used to be convenient but are now frustrating (i.e., converting character vectors to factors). I also used its superior printing method by using <code>glimpse()</code> instead of <code>str()</code>.</p>
<div class="warningbox">
<p>Watch the difference between <code>bv</code> and <code>pb</code> version: The function <code>read.table()</code> (with a period) in <code>bv</code> is called from the <strong>{base}</strong> package, whereas <code>read_table()</code> (with an underscore) in <code>pb</code> is part of <strong>{readr}</strong> and has to be loaded as a library.</p>
</div>
<p><strong>2.Step</strong>: In the next step I recoded all factor labels with <code>fct_recode()</code> from the <strong>{forcats}</strong> package. I overwrote their old values with <code>mutate()</code> from the <strong>{dplyr}</strong> package.</p>
<p>I linked all commands of the sequence with the <a href="https://magrittr.tidyverse.org/">pipe operator</a> <code>%&gt;%</code> using a different appearance |&gt; with a particular font. All the mentioned packages — including the pipe operator — are part of the <strong>{tidyverse}</strong> meta-package, which has to be loaded.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="working-with-categorical-data.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-2"><a href="working-with-categorical-data.html#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="working-with-categorical-data.html#cb15-3" aria-hidden="true" tabindex="-1"></a>tv_pb <span class="ot">&lt;-</span></span>
<span id="cb15-4"><a href="working-with-categorical-data.html#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_fwf</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;tv.dat&quot;</span>,   <span class="co"># without the &quot;doc&quot; directory</span></span>
<span id="cb15-5"><a href="working-with-categorical-data.html#cb15-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">package =</span> <span class="st">&quot;vcdExtra&quot;</span>),</span>
<span id="cb15-6"><a href="working-with-categorical-data.html#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">col_types =</span> <span class="st">&#39;ffffi&#39;</span>,</span>
<span id="cb15-7"><a href="working-with-categorical-data.html#cb15-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fwf_widths</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb15-8"><a href="working-with-categorical-data.html#cb15-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Network&quot;</span>, <span class="st">&quot;State&quot;</span>, <span class="st">&quot;Freq&quot;</span>)</span>
<span id="cb15-9"><a href="working-with-categorical-data.html#cb15-9" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span></span>
<span id="cb15-10"><a href="working-with-categorical-data.html#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb15-11"><a href="working-with-categorical-data.html#cb15-11" aria-hidden="true" tabindex="-1"></a>        Day,</span>
<span id="cb15-12"><a href="working-with-categorical-data.html#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">Mon =</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb15-13"><a href="working-with-categorical-data.html#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">Tue =</span> <span class="st">&quot;2&quot;</span>,</span>
<span id="cb15-14"><a href="working-with-categorical-data.html#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">Wed =</span> <span class="st">&quot;3&quot;</span>,</span>
<span id="cb15-15"><a href="working-with-categorical-data.html#cb15-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">Thu =</span> <span class="st">&quot;4&quot;</span>,</span>
<span id="cb15-16"><a href="working-with-categorical-data.html#cb15-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">Fri =</span> <span class="st">&quot;5&quot;</span></span>
<span id="cb15-17"><a href="working-with-categorical-data.html#cb15-17" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span></span>
<span id="cb15-18"><a href="working-with-categorical-data.html#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-19"><a href="working-with-categorical-data.html#cb15-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">Time =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb15-20"><a href="working-with-categorical-data.html#cb15-20" aria-hidden="true" tabindex="-1"></a>            Time,</span>
<span id="cb15-21"><a href="working-with-categorical-data.html#cb15-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;8:00&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb15-22"><a href="working-with-categorical-data.html#cb15-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;8:15&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>,</span>
<span id="cb15-23"><a href="working-with-categorical-data.html#cb15-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;8:30&quot;</span> <span class="ot">=</span> <span class="st">&quot;3&quot;</span>,</span>
<span id="cb15-24"><a href="working-with-categorical-data.html#cb15-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;8:45&quot;</span> <span class="ot">=</span> <span class="st">&quot;4&quot;</span>,</span>
<span id="cb15-25"><a href="working-with-categorical-data.html#cb15-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;9:00&quot;</span> <span class="ot">=</span> <span class="st">&quot;5&quot;</span>,</span>
<span id="cb15-26"><a href="working-with-categorical-data.html#cb15-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;9:15&quot;</span> <span class="ot">=</span> <span class="st">&quot;6&quot;</span>,</span>
<span id="cb15-27"><a href="working-with-categorical-data.html#cb15-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;9:30&quot;</span> <span class="ot">=</span> <span class="st">&quot;7&quot;</span>,</span>
<span id="cb15-28"><a href="working-with-categorical-data.html#cb15-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;9:45&quot;</span> <span class="ot">=</span> <span class="st">&quot;8&quot;</span>,</span>
<span id="cb15-29"><a href="working-with-categorical-data.html#cb15-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;10:00&quot;</span> <span class="ot">=</span> <span class="st">&quot;9&quot;</span>,</span>
<span id="cb15-30"><a href="working-with-categorical-data.html#cb15-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;10:15&quot;</span> <span class="ot">=</span> <span class="st">&quot;10&quot;</span>,</span>
<span id="cb15-31"><a href="working-with-categorical-data.html#cb15-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;10:30&quot;</span> <span class="ot">=</span> <span class="st">&quot;11&quot;</span></span>
<span id="cb15-32"><a href="working-with-categorical-data.html#cb15-32" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-33"><a href="working-with-categorical-data.html#cb15-33" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb15-34"><a href="working-with-categorical-data.html#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Network =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb15-35"><a href="working-with-categorical-data.html#cb15-35" aria-hidden="true" tabindex="-1"></a>        Network,</span>
<span id="cb15-36"><a href="working-with-categorical-data.html#cb15-36" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;ABC&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb15-37"><a href="working-with-categorical-data.html#cb15-37" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;CBS&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>,</span>
<span id="cb15-38"><a href="working-with-categorical-data.html#cb15-38" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;NBC&quot;</span> <span class="ot">=</span> <span class="st">&quot;3&quot;</span>,</span>
<span id="cb15-39"><a href="working-with-categorical-data.html#cb15-39" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Fox&quot;</span> <span class="ot">=</span> <span class="st">&quot;4&quot;</span>,</span>
<span id="cb15-40"><a href="working-with-categorical-data.html#cb15-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Other&quot;</span> <span class="ot">=</span> <span class="st">&quot;5&quot;</span></span>
<span id="cb15-41"><a href="working-with-categorical-data.html#cb15-41" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">|&gt;</span></span>
<span id="cb15-42"><a href="working-with-categorical-data.html#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">State =</span> <span class="fu">fct_recode</span>(</span>
<span id="cb15-43"><a href="working-with-categorical-data.html#cb15-43" aria-hidden="true" tabindex="-1"></a>        State,</span>
<span id="cb15-44"><a href="working-with-categorical-data.html#cb15-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Off&quot;</span> <span class="ot">=</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb15-45"><a href="working-with-categorical-data.html#cb15-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Switch&quot;</span> <span class="ot">=</span> <span class="st">&quot;2&quot;</span>,</span>
<span id="cb15-46"><a href="working-with-categorical-data.html#cb15-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Persist&quot;</span> <span class="ot">=</span> <span class="st">&quot;3&quot;</span></span>
<span id="cb15-47"><a href="working-with-categorical-data.html#cb15-47" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb15-48"><a href="working-with-categorical-data.html#cb15-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-49"><a href="working-with-categorical-data.html#cb15-49" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tv_pb)</span>
<span id="cb15-50"><a href="working-with-categorical-data.html#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Rows: 825</span></span>
<span id="cb15-51"><a href="working-with-categorical-data.html#cb15-51" aria-hidden="true" tabindex="-1"></a><span class="do">## Columns: 5</span></span>
<span id="cb15-52"><a href="working-with-categorical-data.html#cb15-52" aria-hidden="true" tabindex="-1"></a><span class="do">## $ Day     &lt;fct&gt; Mon, Tue, Wed, Thu, Fri, Mon, Tue, Wed, Thu, Fri, Mon, Tue, We…</span></span>
<span id="cb15-53"><a href="working-with-categorical-data.html#cb15-53" aria-hidden="true" tabindex="-1"></a><span class="do">## $ Time    &lt;fct&gt; 8:00, 8:00, 8:00, 8:00, 8:00, 8:15, 8:15, 8:15, 8:15, 8:15, 8:…</span></span>
<span id="cb15-54"><a href="working-with-categorical-data.html#cb15-54" aria-hidden="true" tabindex="-1"></a><span class="do">## $ Network &lt;fct&gt; ABC, ABC, ABC, ABC, ABC, ABC, ABC, ABC, ABC, ABC, ABC, ABC, AB…</span></span>
<span id="cb15-55"><a href="working-with-categorical-data.html#cb15-55" aria-hidden="true" tabindex="-1"></a><span class="do">## $ State   &lt;fct&gt; Off, Off, Off, Off, Off, Off, Off, Off, Off, Off, Off, Off, Of…</span></span>
<span id="cb15-56"><a href="working-with-categorical-data.html#cb15-56" aria-hidden="true" tabindex="-1"></a><span class="do">## $ Freq    &lt;int&gt; 6, 18, 6, 2, 11, 6, 29, 25, 17, 29, 10, 10, 12, 8, 7, 20, 24, …</span></span>
<span id="cb15-57"><a href="working-with-categorical-data.html#cb15-57" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tv_pb, <span class="dv">5</span>)</span>
<span id="cb15-58"><a href="working-with-categorical-data.html#cb15-58" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 5 × 5</span></span>
<span id="cb15-59"><a href="working-with-categorical-data.html#cb15-59" aria-hidden="true" tabindex="-1"></a><span class="do">##   Day   Time  Network State  Freq</span></span>
<span id="cb15-60"><a href="working-with-categorical-data.html#cb15-60" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;   &lt;fct&gt; &lt;int&gt;</span></span>
<span id="cb15-61"><a href="working-with-categorical-data.html#cb15-61" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Mon   8:00  ABC     Off       6</span></span>
<span id="cb15-62"><a href="working-with-categorical-data.html#cb15-62" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 Tue   8:00  ABC     Off      18</span></span>
<span id="cb15-63"><a href="working-with-categorical-data.html#cb15-63" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 Wed   8:00  ABC     Off       6</span></span>
<span id="cb15-64"><a href="working-with-categorical-data.html#cb15-64" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 Thu   8:00  ABC     Off       2</span></span>
<span id="cb15-65"><a href="working-with-categorical-data.html#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 Fri   8:00  ABC     Off      11</span></span></code></pre></div>
</div>
<div id="summary" class="section level3" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Summary</h3>
<p>After some troubles with the import command (using <code>read_fwf()</code> instead of <code>read_table()</code>), I had no difficulties converting the code to the newer tidyverse approach. The book version uses for re-coding the implicit order of the factor levels. The bv-code is, therefore, shorter than my pb-conversion.
On the other hand, the tidyverse version is perhaps more neatly arranged and better understandable. But I admit that there is no advantage over the book version in this example.</p>
<div class="successbox">
<p>The goal was to demonstrate if I could manage to convert the book’s code into a version where I do not need to use the special table commands like <code>ftable()</code>, <code>xtable()</code>, <code>structable()</code>. At least with the example of <code>xtable(),</code> I have succeeded.</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="still-to-do.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/petzi53/cdar/edit/master/02-categorical-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
